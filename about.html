<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>About - Fruits</title>
  <link rel="stylesheet" href="/vendor/bootstrap-4.3.1.min.css">
  <link rel="stylesheet" href="/vendor/fontawesome-5.8.1.min.css">
  <link rel="stylesheet" href="/vendor/solarized-light.css">
  <link rel="stylesheet" href="/assets/style.css" media="screen" type="text/css">
  <!-- add in  icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

</head>


<body>
<!-- Navigation -->
<div class="bg-dark">
  <div class="container bg-dark">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/">Fruits</a> &nbsp;
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          
          
          
          <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
          
          <li class="nav-item"><a class="nav-link" href="/all.html">All fruits</a></li>
          
          <li class="nav-item"><a class="nav-link" href="/about.html">About</a></li>
          
        </ul>
      </div>
    </nav>
  </div>
</div>

<div class="main">

<div class="container">
	<div class="row">
		<div class="col">
			<h1>About</h1>
		</div>
	</div>
	<div class="row">
		<div class="col">
    	<p>How this prototype is built…</p>

<h2 id="data">Data</h2>

<p>All items are listed in one file <strong>fruits.csv</strong> which is loaded into <strong>site.data.fruits</strong> array.</p>

<table class="table table-sm tableauto">
  <thead>
    <tr>
      <th>fruitname</th>
      <th>origin</th>
      <th>category</th>
      <th>colour</th>
      <th>image</th>
      <th>blurb</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Bananas</td>
      <td>Asia</td>
      <td>tropical</td>
      <td>yellow</td>
      <td>Bananas.jpg</td>
      <td>“Generally, it is agreed that bananas …”</td>
    </tr>
    <tr>
      <td>Strawberries</td>
      <td>North America</td>
      <td>berries</td>
      <td>red</td>
      <td>Strawberries.jpg</td>
      <td>“The garden strawberry …”</td>
    </tr>
  </tbody>
</table>

<h2 id="all-fruits-index">All fruits index</h2>

<p>Simply loop through all the items in the data file &amp; display as cards:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">fruit</span> <span class="k">in</span> <span class="nx">site</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fruits</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">include</span> <span class="nx">card</span><span class="p">.</span><span class="nx">html</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span></code></pre></figure>

<p>Where card.html is as below.<br />This calculates the link for each item from the <strong>fruitname</strong>; this matches the logic used by the jekyll-datapage_gen plugin when creating the pages.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">fruitname</span> <span class="o">|</span> <span class="na">remove</span><span class="p">:</span> <span class="s2">" "</span> <span class="o">|</span> <span class="nx">downcase</span> <span class="o">|</span> <span class="na">prepend</span><span class="p">:</span> <span class="s2">"/fruits/"</span><span class="o">|</span> <span class="na">append</span><span class="p">:</span> <span class="s2">".html"</span> <span class="o">%</span><span class="p">}</span>

  <span class="nl">title</span><span class="p">:</span>        <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">fruitname</span> <span class="p">}}</span>
  <span class="nl">thumbnail</span><span class="p">:</span>    <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">image</span> <span class="p">}}</span>
  <span class="nl">descriptiuon</span><span class="p">:</span> <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">blurb</span> <span class="p">}}</span>
<span class="o">&lt;</span><span class="sr">/div&gt;</span></code></pre></figure>

<h2 id="item--pages">Item  pages</h2>

<p>Use the <a href="https://github.com/avillafiorita/jekyll-datapage_gen">jekyll-datapage_gen</a> plugin to generate one page per <strong>item</strong> (row) in the datafile.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">plugins</span><span class="p">:</span>
  <span class="o">-</span> <span class="nx">jekyll</span><span class="o">-</span><span class="nx">datapage</span><span class="o">-</span><span class="nx">generator</span>

<span class="nx">page_gen</span><span class="p">:</span>
  <span class="o">-</span> <span class="nx">data</span><span class="p">:</span> <span class="s1">'fruits'</span>                                <span class="c1">// datasource</span>
    <span class="nx">template</span><span class="p">:</span> <span class="s1">'fruit'</span>                             <span class="c1">// page template</span>
    <span class="nx">dir</span><span class="p">:</span> <span class="s1">'fruits'</span>                                 <span class="c1">// output directory</span>
    <span class="nx">name_expr</span><span class="p">:</span> <span class="s1">'record["fruitname"].delete(" ")'</span>  <span class="c1">// create filename from this field (+ strip spaces)</span>
    <span class="nx">title</span><span class="p">:</span> <span class="s1">'fruitname'</span>                            <span class="c1">// field for page title</span></code></pre></figure>

<p>Creates page per item in /fruits/ eg <a href="/fruits/bananas.html">Bananas</a>.</p>

<h4 id="fruit-template">Fruit template</h4>
<p>All item data from the CSV is available as page variables. The variables are mapped to the CSV column headings eg</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;h1&gt;</span> {{ page.fruitname }} <span class="nt">&lt;/h1&gt;</span>
origin: {{ page.origin }}
category: {{ page.category }}
colour: {{ page.colour }}</code></pre></figure>

<p>Can calculate the link for each <strong>category</strong> (eg “apples” links to the category page for “apples”) from the category name; this matches the logic used by the jekyll-datapage_gen plugin when creating the category indexes (see below).</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">category</span> <span class="o">|</span> <span class="nx">remove</span><span class="p">:</span> <span class="s2">" "</span> <span class="o">|</span> <span class="nx">prepend</span><span class="p">:</span> <span class="s2">"/category/"</span> <span class="o">|</span> <span class="nx">append</span><span class="p">:</span> <span class="s2">".html"</span> <span class="o">%</span><span class="p">}</span></code></pre></figure>

<h2 id="category-index-pages">Category index pages</h2>

<p>Use the <a href="https://github.com/avillafiorita/jekyll-datapage_gen">jekyll-datapage_gen</a> plugin to generate one page per <strong>category</strong> in the datafile. This category page can be used as an index for all items in this category.</p>

<p>I suspect it creates a page for each <strong>item</strong> but all items in one category have the same <strong>filename</strong> so end up with just one file per category.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">page_gen</span><span class="p">:</span>
  <span class="o">-</span> <span class="nx">data</span><span class="p">:</span> <span class="s1">'fruits'</span>                                <span class="c1">// datasource</span>
    <span class="nx">template</span><span class="p">:</span> <span class="s1">'cat'</span>                               <span class="c1">// page template</span>
    <span class="nx">dir</span><span class="p">:</span> <span class="s1">'category'</span>                               <span class="c1">// output directory</span>
    <span class="nx">name_expr</span><span class="p">:</span> <span class="s1">'record["category"].delete(" ")'</span>   <span class="c1">// create filename from this field (+ strip spaces)</span>
    <span class="nx">title</span><span class="p">:</span> <span class="s1">'category'</span>                             <span class="c1">// field for page title</span></code></pre></figure>

<h4 id="cat-template">Cat template</h4>

<p>All item data from the CSV is available as page variables. The variables are mapped to the CSV column headings. This includes <strong>this category</strong> eg</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;h1&gt;</span> {{ page.category | capitalize }} <span class="nt">&lt;/h1&gt;</span></code></pre></figure>

<p>Like the <strong>All fruits index</strong> loop  through all the items in the data file &amp; display as cards. But first <strong>filter</strong> so just display ones in this category:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">(</span><span class="nx">site</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fruits</span> <span class="o">|</span> <span class="nx">where</span><span class="p">:</span> <span class="s2">"category"</span><span class="p">,</span> <span class="nx">page</span><span class="p">.</span><span class="nx">category</span><span class="p">)</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">fruit</span> <span class="k">in</span> <span class="nx">fruits</span> <span class="o">%</span><span class="p">}</span>
  <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
    <span class="nx">title</span><span class="p">:</span>        <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">fruitname</span> <span class="p">}}</span>
    <span class="nl">thumbnail</span><span class="p">:</span>    <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">image</span> <span class="p">}}</span>
    <span class="nl">descriptiuon</span><span class="p">:</span> <span class="p">{{</span> <span class="nx">fruit</span><span class="p">.</span><span class="nx">blurb</span> <span class="p">}}</span>
  <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span><span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span></code></pre></figure>

<p>Creates page per category in /category/ eg <a href="/category/tropical.html">Tropical</a></p>

<h2 id="list-of-categories">List of categories</h2>

<p>Extract just the field of interest (eg category or colour) from all the items,
filter this to remove duplicates and then loop through this to produce a list of categories.</p>

<p>eg Categories: Apples, Berries, Citrus, …<br />
eg Colours: Black, Green, Orange, …</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
<span class="c">&lt;!--</span> <span class="s1">'map'</span> <span class="nx">so</span> <span class="nx">only</span> <span class="nx">category</span> <span class="nx">property</span> <span class="o">+</span> <span class="s1">'uniq'</span> <span class="nx">to</span> <span class="nx">remove</span> <span class="nx">duplicates</span> <span class="o">=&gt;</span> <span class="nx">simple</span> <span class="nx">list</span> <span class="k">of</span> <span class="nx">cats</span> <span class="o">--&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">cats</span> <span class="o">=</span> <span class="nx">site</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fruits</span> <span class="o">|</span> <span class="na">map</span><span class="p">:</span> <span class="s2">"category"</span><span class="o">|</span> <span class="nx">uniq</span> <span class="o">|</span> <span class="nx">sort</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">cat</span> <span class="k">in</span> <span class="nx">cats</span> <span class="o">%</span><span class="p">}</span>
  <span class="c">&lt;!--</span> <span class="nx">remove</span> <span class="nx">spaces</span> <span class="o">+</span> <span class="nx">top</span> <span class="o">&amp;</span> <span class="nx">tail</span> <span class="o">=&gt;</span> <span class="sr">/category/</span><span class="o">&lt;</span><span class="nx">thiscat</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">html</span> <span class="o">--&gt;</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">cat</span> <span class="o">|</span> <span class="na">remove</span><span class="p">:</span> <span class="s2">" "</span> <span class="o">|</span> <span class="na">prepend</span><span class="p">:</span> <span class="s2">"/category/"</span> <span class="o">|</span> <span class="na">append</span><span class="p">:</span> <span class="s2">".html"</span> <span class="o">%</span><span class="p">}</span>
  <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"{{link}}"</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">cat</span> <span class="o">|</span> <span class="nx">capitalize</span> <span class="p">}}</span><span class="o">&lt;</span><span class="sr">/a&gt;&lt;/</span><span class="nx">li</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/ul&gt;</span></code></pre></figure>

<h4 id="tiles-of-categories">Tiles of categories</h4>

<p>Similarly can create tiles, not just a list, of categories.</p>

<p>The key here is to have a category thumbnail, named after the category.
eg <code class="highlighter-rouge">/categoryThumbs/ &lt;category&gt;.jpg</code>
<br /> eg /categoryThumbs/apples.jpg</p>

<p>ie this is defined by <strong>convention</strong> not data or configuration (so no extra data required!)</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c">&lt;!--</span> <span class="s1">'map'</span> <span class="nx">so</span> <span class="nx">only</span> <span class="nx">category</span> <span class="nx">property</span> <span class="o">+</span> <span class="s1">'uniq'</span> <span class="nx">to</span> <span class="nx">remove</span> <span class="nx">duplicates</span> <span class="o">=&gt;</span> <span class="nx">simple</span> <span class="nx">list</span> <span class="k">of</span> <span class="nx">cats</span> <span class="o">--&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">cats</span> <span class="o">=</span> <span class="nx">site</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fruits</span> <span class="o">|</span> <span class="na">map</span><span class="p">:</span> <span class="s2">"category"</span><span class="o">|</span> <span class="nx">uniq</span> <span class="o">|</span> <span class="nx">sort</span>  <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">category</span> <span class="k">in</span> <span class="nx">cats</span> <span class="o">%</span><span class="p">}</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">include</span> <span class="nx">tile</span><span class="p">.</span><span class="nx">html</span> <span class="o">%</span><span class="p">}</span>
<span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span></code></pre></figure>

<p>Where tile.html is:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">div</span> <span class="kd">class</span><span class="o">=</span><span class="s2">"tile"</span><span class="o">&gt;</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">thumb</span> <span class="o">=</span> <span class="nx">category</span> <span class="o">|</span> <span class="na">remove</span><span class="p">:</span> <span class="s2">" "</span> <span class="o">|</span> <span class="nx">downcase</span> <span class="o">|</span> <span class="na">prepend</span><span class="p">:</span> <span class="s2">"/categoryThumbs/"</span><span class="o">|</span> <span class="na">append</span><span class="p">:</span> <span class="s2">".jpg"</span> <span class="o">%</span><span class="p">}</span>
  <span class="nl">img</span><span class="p">:</span>   <span class="p">{{</span> <span class="nx">thumb</span> <span class="p">}}</span>
  <span class="nl">title</span><span class="p">:</span> <span class="p">{{</span><span class="nx">category</span> <span class="o">|</span> <span class="nx">capitalize</span> <span class="p">}}</span>
  <span class="p">{</span><span class="o">%</span> <span class="nx">assign</span> <span class="nx">link</span> <span class="o">=</span> <span class="nx">category</span> <span class="o">|</span> <span class="nx">remove</span><span class="p">:</span> <span class="s2">" "</span> <span class="o">|</span> <span class="nx">downcase</span> <span class="o">|</span> <span class="nx">prepend</span><span class="p">:</span> <span class="s2">"/category/"</span><span class="o">|</span> <span class="nx">append</span><span class="p">:</span> <span class="s2">".html"</span> <span class="o">%</span><span class="p">}</span>
<span class="o">&lt;</span><span class="sr">/div&gt;</span></code></pre></figure>

<h2 id="publishing-jekyll-site-using-github-pages">Publishing Jekyll site using Github pages</h2>

<p>Normal github pages workflow:</p>

<ul>
  <li>commit sourcecode to <strong>master</strong></li>
  <li>exclude _site  (ie compiled HTML)</li>
  <li>push to <strong>master</strong>
    <ul>
      <li>github builds _site &amp; publishes as github pages</li>
    </ul>
  </li>
</ul>

<p>Github pages doesn’t support custom plugins so instead we will compile the site using jekyll locally and then push the resulting compiled HTML to github (eg see <a href="https://www.drewsilcock.co.uk/custom-jekyll-plugins">Drew</a>).</p>

<ul>
  <li>commit sourcecode to <strong>master</strong>
    <ul>
      <li>exclude _site</li>
      <li>push to remote <strong>master</strong></li>
    </ul>
  </li>
  <li>create <strong>second</strong> local repository in _site
    <ul>
      <li>push to this to a second remote branch eg <strong>livesite</strong></li>
      <li>configure github to serve site from this branch</li>
    </ul>
  </li>
</ul>

<p>ie two local repositories pushing to different branches in single remote repository</p>

<h3 id="details">Details</h3>

<ul>
  <li>make a new local git repository within _site
    <ul>
      <li><code class="highlighter-rouge">cd _site</code></li>
      <li><code class="highlighter-rouge">git init</code></li>
    </ul>
  </li>
  <li>make new “livesite” branch
    <ul>
      <li><code class="highlighter-rouge">git checkout -b livesite</code></li>
    </ul>
  </li>
  <li>tell Jekyll to ignore this directory
    <ul>
      <li><code class="highlighter-rouge">touch .nojekyll</code></li>
    </ul>
  </li>
  <li>add files &amp; commit them
    <ul>
      <li><code class="highlighter-rouge">git add .</code></li>
      <li><code class="highlighter-rouge">git commit -m "new site"</code></li>
    </ul>
  </li>
  <li>define remote that will push to
    <ul>
      <li>ie <code class="highlighter-rouge">git remote add &lt;nameForRemote&gt; &lt;remoteUrl&gt;</code></li>
      <li>eg <code class="highlighter-rouge">git remote add fruits https://github.com/drmikeuk/fruits.git</code></li>
    </ul>
  </li>
  <li>push to this remote / livesite branch on command line:
    <ul>
      <li>ie <code class="highlighter-rouge">git push &lt;remote&gt; &lt;branch&gt;</code></li>
      <li>eg <code class="highlighter-rouge">git push fruits livesite</code></li>
    </ul>
  </li>
</ul>

		</div>
	</div>
</div>


</div>
<!-- FOOTER -->
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-9 col-sm-12">
        <h3>Fruits</h3>
        <p><i>An example Jekyll site built from CSV and some templates</i>.</p>
        <p><a href="/about/"><i class="fas fa-info-circle" aria-hidden="true"></i> About the project</a></p>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-md-4">
        <h4>Categories</h4>
      	<ul>
      	
      	
      	
      		
      		
      		<li><a href="/category/apples.html">Apples</a></li>
      	
      		
      		
      		<li><a href="/category/berries.html">Berries</a></li>
      	
      		
      		
      		<li><a href="/category/citrus.html">Citrus</a></li>
      	
      		
      		
      		<li><a href="/category/grapes.html">Grapes</a></li>
      	
      		
      		
      		<li><a href="/category/tropical.html">Tropical</a></li>
      	
      	</ul>
      </div>
      <div class="col-md-4">
        <h4>Colours</h4>
      	<ul>
      	
      	
      	
      		
      		
      		<li><a href="/colour/black.html">Black</a></li>
      	
      		
      		
      		<li><a href="/colour/green.html">Green</a></li>
      	
      		
      		
      		<li><a href="/colour/orange.html">Orange</a></li>
      	
      		
      		
      		<li><a href="/colour/red.html">Red</a></li>
      	
      		
      		
      		<li><a href="/colour/yellow.html">Yellow</a></li>
      	
      	</ul>
      </div>
    </div>
  </div>
</div>








<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="/vendor/jquery-3.3.1.slim.min.js "></script>
<script src="/vendor/popper.min.js "></script>
<script src="/vendor/bootstrap-4.3.1.min.js "></script>

</body>
</html>
